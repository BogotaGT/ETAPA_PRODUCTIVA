<!-- Ruta: vistas/aprendiz/index.ejs -->
<!-- Propósito: Formulario de registro inicial para aprendices.
     Permite capturar datos personales, de ubicación, formación y alternativa de etapa productiva.
     Incluye validaciones en tiempo real y manejo de mensajes con feedback sonoro. -->

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestión de Etapa Productiva</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <!-- Estilos específicos para el popup -->
    <style>
        .info-text {
            color: #04324d;
            cursor: pointer;
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            border-left: 4px solid #39a900;
            background: #f8f9fa;
        }

        .info-icon {
            margin-left: 8px;
            color: #39a900;
            font-size: 1.2em;
        }

        .popup-info {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
            display: none;
        }

        .popup-info.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .popup-overlay.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -48%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
    </style>
</head>
<body>
<%- include('../parciales/admin-header') %>

<div class="container mt-4">
    <div class="row">
        <!-- Sección de información y alternativas -->
        <div class="col-md-3 mb-4">
            <div class="nav-section">
                <a href="#" id="btnAlternativas" class="btn btn-primary w-100">
                    Alternativas de etapa productiva
                </a>
                <p class="info-text" id="btnInfo">
                    Aprende más sobre las diferentes etapas productivas
                    <span class="info-icon">ⓘ</span>
                </p>
            </div>
        </div>

        <!-- Formulario principal -->
        <div class="col-md-9">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h2 class="form-header mb-0">DATOS DEL APRENDIZ</h2>
                </div>
                <div class="card-body">
                    <form id="aprendizForm" action="/submit-form" method="POST">

                        <h3 class="form-subheader mt-4">Datos Personales</h3>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="nombres" class="form-label">Nombres*</label>
                                <input type="text" class="form-control" id="nombres" name="nombres" required>
                            </div>
                            <div class="col-md-4">
                                <label for="primerApellido" class="form-label">Primer apellido*</label>
                                <input type="text" class="form-control" id="primerApellido" name="primerApellido" required>
                            </div>
                            <div class="col-md-4">
                                <label for="segundoApellido" class="form-label">Segundo apellido</label>
                                <input type="text" class="form-control" id="segundoApellido" name="segundoApellido">
                            </div>
                            <div class="col-md-3">
                                <label for="tipoDocumento" class="form-label">Tipo de documento*</label>
                                <select class="form-select" id="tipoDocumento" name="tipoDocumento" required>
                                    <option value="">Seleccione...</option>
                                    <option value="CC">Cédula de ciudadanía</option>
                                    <option value="TI">Tarjeta de identidad</option>
                                    <option value="CE">Cédula de extranjería</option>
                                    <option value="PEP">PEP</option>
                                    <option value="PPT">Permiso de protección temporal</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="numeroDocumento" class="form-label">Número de documento*</label>
                                <input type="text" class="form-control" id="numeroDocumento" name="numeroDocumento" required>
                            </div>
                            <div class="col-md-3">
                                <label for="fechaNacimiento" class="form-label">Fecha de nacimiento*</label>
                                <input type="date" class="form-control" id="fechaNacimiento" name="fechaNacimiento" required>
                            </div>
                            <div class="col-md-3">
                                <label for="eps" class="form-label">EPS</label>
                                <select class="form-select" id="eps" name="eps">
                                    <option value="">Seleccione...</option>
                                    <option value="COOSALUD EPS-S">COOSALUD EPS-S</option>
                                    <option value="NUEVA EPS">NUEVA EPS</option>
                                    <option value="MUTUAL SER">MUTUAL SER</option>
                                    <option value="ALIANSALUD EPS">ALIANSALUD EPS</option>
                                    <option value="SALUD TOTAL EPS S.A.">SALUD TOTAL EPS S.A.</option>
                                    <option value="EPS SANITAS">EPS SANITAS</option>
                                    <option value="EPS SURA">EPS SURA</option>
                                    <option value="FAMISANAR">FAMISANAR</option>
                                    <option value="SERVICIO OCCIDENTAL DE SALUD EPS SOS">SERVICIO OCCIDENTAL DE SALUD EPS SOS</option>
                                    <option value="SALUD MIA">SALUD MIA</option>
                                    <option value="COMFENALCO VALLE">COMFENALCO VALLE</option>
                                    <option value="COMPENSAR EPS">COMPENSAR EPS</option>
                                    <option value="EPM - EMPRESAS PUBLICAS DE MEDELLIN">EPM - EMPRESAS PUBLICAS DE MEDELLIN</option>
                                    <option value="FONDO DE PASIVO SOCIAL DE FERROCARRILES NACIONALES DE COLOMBIA">FONDO DE PASIVO SOCIAL DE FERROCARRILES NACIONALES DE COLOMBIA</option>
                                    <option value="CAJACOPI ATLANTICO">CAJACOPI ATLANTICO</option>
                                    <option value="CAPRESOCA">CAPRESOCA</option>
                                    <option value="COMFACHOCO">COMFACHOCO</option>
                                    <option value="COMFAORIENTE">COMFAORIENTE</option>
                                    <option value="EPS FAMILIAR DE COLOMBIA">EPS FAMILIAR DE COLOMBIA</option>
                                    <option value="ASMET SALUD">ASMET SALUD</option>
                                    <option value="EMSSANAR E.S.S.">EMSSANAR E.S.S.</option>
                                    <option value="CAPITAL SALUD EPS-S">CAPITAL SALUD EPS-S</option>
                                    <option value="SAVIA SALUD EPS">SAVIA SALUD EPS</option>
                                    <option value="DUSAKAWI EPSI">DUSAKAWI EPSI</option>
                                    <option value="ASOCIACION INDIGENA DEL CAUCA EPSI">ASOCIACION INDIGENA DEL CAUCA EPSI</option>
                                    <option value="ANAS WAYUU EPSI">ANAS WAYUU EPSI</option>
                                    <option value="MALLAMAS EPSI">MALLAMAS EPSI</option>
                                    <option value="PIJAOS SALUD EPSI">PIJAOS SALUD EPSI</option>
                                    <option value="SALUD BÓLIVAR EPS SAS">SALUD BÓLIVAR EPS SAS</option>
                                    <option value="NO APLICA">NO APLICA</option>
                                </select>
                            </div>
                        </div>

                        <h3 class="form-subheader mt-4">Datos de Ubicación</h3>
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label for="telefonoFijo" class="form-label">Teléfono fijo</label>
                                <input type="tel" class="form-control" id="telefonoFijo" name="telefonoFijo">
                            </div>
                            <div class="col-md-3">
                                <label for="celular" class="form-label">Celular*</label>
                                <input type="tel" class="form-control" id="celular" name="celular" required>
                            </div>
                            <div class="col-md-6">
                                <label for="direccion" class="form-label">Dirección de residencia*</label>
                                <input type="text" class="form-control" id="direccion" name="direccion" required>
                            </div>
                            <div class="col-md-3">
                                <label for="barrio" class="form-label">Barrio</label>
                                <input type="text" class="form-control" id="barrio" name="barrio">
                            </div>
                            <div class="col-md-3">
                                <label for="departamento" class="form-label">Departamento*</label>
                                <select class="form-select" id="departamento" name="departamento" required>
                                    <option value="">Seleccione...</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="municipio" class="form-label">Municipio*</label>
                                <select class="form-select" id="municipio" name="municipio" required>
                                    <option value="">Seleccione un departamento primero</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="correoElectronico" class="form-label">Correo electrónico*</label>
                                <input type="email" class="form-control" id="correoElectronico" name="correoElectronico" required>
                            </div>
                        </div>

                        <h3 class="form-subheader mt-4">Datos de la Formación</h3>
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label for="fechaInicioFormacion" class="form-label">Fecha inicio de formación</label>
                                <input type="date" class="form-control" id="fechaInicioFormacion" name="fechaInicioFormacion">
                            </div>
                            <div class="col-md-3">
                                <label for="fechaInicioLectiva" class="form-label">Fecha inicio etapa lectiva</label>
                                <input type="date" class="form-control" id="fechaInicioLectiva" name="fechaInicioLectiva">
                            </div>
                            <div class="col-md-3">
                                <label for="fechaFinLectiva" class="form-label">Fecha fin etapa lectiva</label>
                                <input type="date" class="form-control" id="fechaFinLectiva" name="fechaFinLectiva">
                            </div>
                            <div class="col-md-3">
                                <label for="instructorLectiva" class="form-label">Instructor/a responsable etapa lectiva</label>
                                <input type="text" class="form-control" id="instructorLectiva" name="instructorLectiva">
                            </div>
                            <div class="col-md-3">
                                <label for="instructorProductiva" class="form-label">Instructor/a responsable etapa productiva</label>
                                <input type="text" class="form-control" id="instructorProductiva" name="instructorProductiva">
                            </div>
                            <div class="col-md-3">
                                <label for="numeroFicha" class="form-label">Número de ficha*</label>
                                <input type="text" class="form-control" id="numeroFicha" name="numeroFicha" required>
                            </div>
                            <div class="col-md-9">
                                <label for="programaFormacion" class="form-label">Programa de formación*</label>
                                <select class="form-select" id="programaFormacion" name="programaFormacion" required>
                                    <option value="">Seleccione...</option>
                                    <option value="tecnoActividadFisica">Tecnología en actividad física</option>
                                    <option value="tecnoEntrenamientoDeportivo">Tecnología en entrenamiento deportivo</option>
                                </select>
                            </div>
                        </div>

                        <h3 class="form-subheader mt-4">Datos de la Alternativa de Etapa Productiva</h3>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="alternativaSeleccionada" class="form-label">Alternativa seleccionada</label>
                                <select class="form-select" id="alternativaSeleccionada" name="alternativaSeleccionada">
                                    <option value="">Seleccione...</option>
                                    <option value="contratoAprendizaje">Contrato de aprendizaje</option>
                                    <option value="pasantia">Pasantía</option>
                                    <option value="apoyoEntidades">Apoyo a entidades</option>
                                    <option value="vinculoLaboral">Vínculo laboral</option>
                                    <option value="proyectosProductivos">Proyectos productivos</option>
                                    <option value="monitoria">Monitoría</option>
                                    <option value="unidadesProductivas">Unidades productivas familiares</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="areaFormacion" class="form-label">¿En el área de formación?</label>
                                <select class="form-select" id="areaFormacion" name="areaFormacion">
                                    <option value="si">Sí</option>
                                    <option value="no">No</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="fechaInicioProductiva" class="form-label">Fecha inicio etapa productiva</label>
                                <input type="date" class="form-control" id="fechaInicioProductiva" name="fechaInicioProductiva">
                            </div>
                            <div class="col-md-3">
                                <label for="fechaFinProductiva" class="form-label">Fecha fin etapa productiva</label>
                                <input type="date" class="form-control" id="fechaFinProductiva" name="fechaFinProductiva">
                            </div>
                            <div class="col-md-6">
                                <label for="empresaPatrocinadora" class="form-label">Empresa patrocinadora</label>
                                <input type="text" class="form-control" id="empresaPatrocinadora" name="empresaPatrocinadora">
                            </div>
                            <div class="col-md-6">
                                <label for="areaPractica" class="form-label">Área donde realiza la práctica</label>
                                <input type="text" class="form-control" id="areaPractica" name="areaPractica">
                            </div>
                            <div class="col-md-4">
                                <label for="jefeInmediato" class="form-label">Nombre del jefe inmediato</label>
                                <input type="text" class="form-control" id="jefeInmediato" name="jefeInmediato">
                            </div>
                            <div class="col-md-4">
                                <label for="telefonoEmpresa" class="form-label">Teléfono fijo</label>
                                <input type="tel" class="form-control" id="telefonoEmpresa" name="telefonoEmpresa">
                            </div>
                            <div class="col-md-4">
                                <label for="celularEmpresa" class="form-label">Celular</label>
                                <input type="tel" class="form-control" id="celularEmpresa" name="celularEmpresa">
                            </div>
                            <div class="col-md-4">
                                <label for="direccionEmpresa" class="form-label">Dirección de la empresa</label>
                                <input type="text" class="form-control" id="direccionEmpresa" name="direccionEmpresa">
                            </div>
                            <div class="col-md-4">
                                <label for="correoEmpresa" class="form-label">Correo de la empresa</label>
                                <input type="email" class="form-control" id="correoEmpresa" name="correoEmpresa">
                            </div>
                            <div class="col-md-4">
                                <label for="horario" class="form-label">Horario</label>
                                <input type="text" class="form-control" id="horario" name="horario" placeholder="Ej: L a V 8:00am a 5:00pm">
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary mt-4">Enviar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Popup Informativo -->
<div class="popup-overlay" id="popupOverlay"></div>
<div class="popup-info" id="popupInfo">
    <h3>Alternativas de Etapa Productiva</h3>
    <div class="popup-content">
        <h4>Contrato de Aprendizaje</h4>
        <p>Relación de trabajo especial con una empresa patrocinadora.</p>

        <h4>Pasantía</h4>
        <p>Práctica en una empresa sin vinculación laboral directa.</p>

        <h4>Proyecto Productivo</h4>
        <p>Desarrollo de un proyecto empresarial o de emprendimiento.</p>

        <h4>Monitoría</h4>
        <p>Apoyo a actividades de formación en el SENA.</p>

        <h4>Vínculo Laboral</h4>
        <p>Contrato de trabajo formal con una empresa.</p>
    </div>
    <button class="btn btn-primary mt-3" id="btnCerrarPopup">Cerrar</button>
</div>

<div id="messageContainer" class="message-container"></div>

<%- include('../parciales/admin-footer') %>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        import { showMessage, showSuccessMessage, showErrorMessage, validaciones } from '/js/utils.js';

        // Hacer disponibles las funciones para otros scripts
        window.showMessage = showMessage;
        window.showSuccessMessage = showSuccessMessage;
        window.showErrorMessage = showErrorMessage;
        window.validaciones = validaciones;

        // Manejo del popup
        document.addEventListener('DOMContentLoaded', function() {
            const btnInfo = document.getElementById('btnInfo');
            const popupInfo = document.getElementById('popupInfo');
            const popupOverlay = document.getElementById('popupOverlay');
            const btnCerrarPopup = document.getElementById('btnCerrarPopup');

            function mostrarPopup() {
                popupInfo.classList.add('active');
                popupOverlay.classList.add('active');
            }

            function ocultarPopup() {
                popupInfo.classList.remove('active');
                popupOverlay.classList.remove('active');
            }

            btnInfo.addEventListener('click', mostrarPopup);
            btnCerrarPopup.addEventListener('click', ocultarPopup);
            popupOverlay.addEventListener('click', ocultarPopup);

            // Cerrar popup con ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && popupInfo.classList.contains('active')) {
                    ocultarPopup();
                }
            });
        });
    </script>
<script src="/js/formValidation.js"></script>
</body>
</html>